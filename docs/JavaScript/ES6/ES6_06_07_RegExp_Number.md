[toc]

## æ­£åˆ™çš„æ‰©å±•

- RegExp æ„é€ å‡½æ•°
- å­—ç¬¦ä¸²çš„æ­£åˆ™æ–¹æ³•
- u ä¿®é¥°ç¬¦
- RegExp.prototype.unicode å±æ€§
- y ä¿®é¥°ç¬¦
- RegExp.prototype.sticky å±æ€§
- RegExp.prototype.flags å±æ€§
- s ä¿®é¥°ç¬¦ï¼šdotAll æ¨¡å¼
- åè¡Œæ–­è¨€
- Unicode å±æ€§ç±»
- å…·åç»„åŒ¹é…
- String.prototype.matchAll

-

### 1. RegExp() æ„é€ å‡½æ•°

 ES5 ä¸­ï¼ŒRegExpæ„é€ å‡½æ•°çš„å‚æ•°æœ‰ä¸¤ç§æƒ…å†µï¼š

- å‚æ•°æ˜¯å­—ç¬¦ä¸²ï¼Œè¿™æ—¶ç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºæ­£åˆ™è¡¨è¾¾å¼çš„ä¿®é¥°ç¬¦ï¼ˆflagï¼‰ã€‚

    ```js
    var regex = new RegExp('xyz', 'i')
    // ç­‰ä»·äº
    var regex = /xyz/i

    ```

- å‚æ•°æ­£åˆ™è¡¨ç¤ºå¼ï¼Œè¿”å›åŸæœ‰æ­£åˆ™è¡¨è¾¾å¼çš„æ‹·è´ã€‚ä¸å…æ—¶ä½¿ç”¨ç¬¬äºŒä¸ªå‚æ•°æ·»åŠ ä¿®é¥°ç¬¦ã€‚

    ```js
    var regex = new RegExp(/xyz/i);
    // ç­‰ä»·äº
    var regex = /xyz/i;
    ```

ES6 ä¸­å…è®¸å‚æ•°ä¸ºæ­£åˆ™æ—¶ä½¿ç”¨ç¬¬äºŒä¸ªå‚æ•°ï¼Œå¹¶ä¸”ä¼˜å…ˆçº§æ¯”æ­£åˆ™ä¸­çš„ä¿®é¥°ç¬¦æ›´é«˜ã€‚

```js
new RegExp(/abc/ig, 'i').flags // è·å–æ­£åˆ™çš„ ä¿®é¥°ç¬¦(flag)
// "i" ç¬¬äºŒä¸ªå‚æ•°æŒ‡å®šçš„ä¿®é¥°ç¬¦è¦†ç›–äº†ç¬¬ä¸€ä¸ªå‚æ•°æ­£åˆ™ä¸­çš„ä¿®é¥°ç¬¦ã€‚

```

### å­—ç¬¦ä¸²çš„æ­£åˆ™æ–¹æ³•

`match()` ã€`replace()` ã€`search()` å’Œ `split()`

### u ä¿®é¥°ç¬¦

ES6 å¯¹æ­£åˆ™è¡¨è¾¾å¼æ·»åŠ äº†uä¿®é¥°ç¬¦ï¼Œå«ä¹‰ä¸ºâ€œUnicode æ¨¡å¼â€ï¼Œç”¨æ¥æ­£ç¡®å¤„ç†å¤§äº\uFFFFçš„ Unicode å­—ç¬¦ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¼šæ­£ç¡®å¤„ç†å››ä¸ªå­—èŠ‚çš„ UTF-16 ç¼–ç ã€‚

```js
// \uD83D\uDC2A æ˜¯ä¸€ä¸ªå››ä¸ªå­—èŠ‚çš„ UTF-16 ç¼–ç ï¼Œä»£è¡¨ä¸€ä¸ªå­—ç¬¦ã€‚

/^\uD83D/.test('\uD83D\uDC2A') // true ES5 ä¸æ”¯æŒå››ä¸ªå­—èŠ‚çš„ UTF-16 ç¼–ç ï¼Œä¼šå°†å…¶è¯†åˆ«ä¸ºä¸¤ä¸ªå­—ç¬¦ï¼Œå¯¼è‡´ç¬¬äºŒè¡Œä»£ç ç»“æœä¸ºtrueã€‚
/^\uD83D/u.test('\uD83D\uDC2A') // false ES6 å°±ä¼šè¯†åˆ«å…¶ä¸ºä¸€ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥ç¬¬ä¸€è¡Œä»£ç ç»“æœä¸ºfalseã€‚

```

```js
// \u004Bä¸\u212Aéƒ½æ˜¯å¤§å†™çš„ Kã€‚

// \u004B åŠ ä¸åŠ ä¿®é¥°ç¬¦ u éƒ½å¯è¯†åˆ«
console.log(/[a-z]/i.test('\u004B')) // true
console.log(/[a-z]/iu.test('\u004B')) // true

// \u212A ä¸åŠ  u åˆ™æ— æ³•è¯†åˆ«
console.log(/[a-z]/i.test('\u212A')) // falseï¼Œè¯†åˆ«ä¸å‡º
console.log(/[a-z]/iu.test('\u212A')) // true

```

##### RegExp.prototype.unicode å±æ€§

æ­£åˆ™å®ä¾‹å¯¹è±¡æ–°å¢unicodeå±æ€§ï¼Œè¡¨ç¤ºæ˜¯å¦è®¾ç½®äº†uä¿®é¥°ç¬¦ã€‚

```
const r1 = /hello/;
const r2 = /hello/u;

r1.unicode // false
r2.unicode // true

```

##### `y`  ä¿®é¥°ç¬¦ -- â€œç²˜è¿â€ï¼ˆstickyï¼‰ä¿®é¥°ç¬¦

###### `y` ä¿®é¥°ç¬¦çš„ä½œç”¨ä¸gä¿®é¥°ç¬¦ç±»ä¼¼ï¼Œä¹Ÿæ˜¯å…¨å±€åŒ¹é…ï¼Œåä¸€æ¬¡åŒ¹é…éƒ½ä»ä¸Šä¸€æ¬¡åŒ¹é…æˆåŠŸçš„ä¸‹ä¸€ä¸ªä½ç½®å¼€å§‹  

###### ä¸åŒä¹‹å¤„ï¼š`g` ä¿®é¥°ç¬¦åªè¦å‰©ä½™ä½ç½®ä¸­å­˜åœ¨åŒ¹é…å°±å¯ï¼Œè€Œ `y` ä¿®é¥°ç¬¦è¦æ±‚å¿…é¡»ä»å‰©ä½™çš„ç¬¬ä¸€ä¸ªä½ç½®å¼€å§‹å°±è¦åŒ¹é…ï¼Œè¿™ä¹Ÿå°±æ˜¯â€œç²˜è¿â€çš„æ¶µä¹‰

```js
var s = 'aaa_aa_a'
var r1 = /a+/g
var r2 = /a+/y

r1.exec(s) // ["aaa"]
r1.exec(s) // ["aa"] // ç¬¬äºŒæ¬¡ä» _ å¼€å§‹å¾€åæ‰¾åˆ°åŒ¹é…é¡¹å³å¯


r2.exec(s) // ["aaa"]
r2.exec(s) // null // ç¬¬äºŒæ¬¡ä» _ å¼€å§‹ï¼Œé‡åˆ°ç¬¬ä¸€ä¸ªå­—ç¬¦å°±ä¸åŒ¹é…ï¼Œæ‰€ä»¥ä¸º null

```

> å®é™…ä¸Šï¼Œ`y` ä¿®é¥°ç¬¦å·éšå«äº†å¤´éƒ¨åŒ¹é…çš„æ ‡å¿—^ã€‚`y` ä¿®é¥°ç¬¦çš„è®¾è®¡æœ¬æ„ï¼Œå°±æ˜¯è®©å¤´éƒ¨åŒ¹é…çš„æ ‡å¿—^åœ¨å…¨å±€åŒ¹é…ä¸­éƒ½æœ‰æ•ˆã€‚

### RegExp.prototype.sticky å±æ€§

åˆ¤æ–­ä¸€ä¸ªæ­£åˆ™å®ä¾‹å¯¹è±¡æ˜¯å¦è®¾ç½®äº† `y` ä¿®é¥°ç¬¦ã€‚

```js
var r = /hello\d/y;
r.sticky // true
```

### RegExp.prototype.flags å±æ€§

è¿”å›ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼çš„æ‰€æœ‰ä¿®é¥°ç¬¦ã€‚

```js
// ES5 çš„ source å±æ€§ï¼Œè¿”å›æ­£åˆ™è¡¨è¾¾å¼çš„æ­£æ–‡
/abc/ig.source // "abc"

// ES6 çš„ flags å±æ€§ï¼Œè¿”å›æ­£åˆ™è¡¨è¾¾å¼çš„ä¿®é¥°ç¬¦
/abc/ig.flags // 'gi'
```

### `s` ä¿®é¥°ç¬¦ï¼šdotAll æ¨¡å¼

ES2018 å¼•å…¥sä¿®é¥°ç¬¦ï¼Œä½¿å¾—`.`å¯ä»¥çœŸæ­£æ„ä¹‰ä¸ŠåŒ¹é…ä»»æ„å•ä¸ªå­—ç¬¦ã€‚  
æ­£åˆ™ä¸­ï¼Œç‚¹ï¼ˆ.ï¼‰æ˜¯ä¸€ä¸ªç‰¹æ®Šå­—ç¬¦ï¼ŒåŒ¹é…ä»»æ„çš„å•ä¸ªå­—ç¬¦ï¼Œä½†æ˜¯æœ‰ä¸¤ä¸ªä¾‹å¤–ã€‚  
ä¸€ä¸ªæ˜¯å››ä¸ªå­—èŠ‚çš„ UTF-16 å­—ç¬¦ï¼Œè¿™ä¸ªå¯ä»¥ç”¨uä¿®é¥°ç¬¦è§£å†³ã€‚

å¦ä¸€ä¸ªæ˜¯è¡Œç»ˆæ­¢ç¬¦ï¼ˆline terminator characterï¼‰ï¼š

- U+000A æ¢è¡Œç¬¦ï¼ˆ\nï¼‰
- U+000D å›è½¦ç¬¦ï¼ˆ\rï¼‰
- U+2028 è¡Œåˆ†éš”ç¬¦ï¼ˆline separatorï¼‰
- U+2029 æ®µåˆ†éš”ç¬¦ï¼ˆparagraph separatorï¼‰

```js
/foo.bar/.test('foo\nbar') // falseï¼Œ. ä¸åŒ¹é… \n
/foo.bar/s.test('foo\nbar') // trueï¼Œä½¿ç”¨ä¿®é¥°ç¬¦ s å¼€å¯ dotAll æ¨¡å¼ï¼ŒçœŸæ­£åŒ¹é…ä»»æ„å•ä¸ªå­—ç¬¦

```

### RegExp.prototype.dotAll å±æ€§

åˆ¤æ–­ä¸€ä¸ªæ­£åˆ™å®ä¾‹å¯¹è±¡æ˜¯å¦å¤„åœ¨dotAllæ¨¡å¼

```js
const re = /foo.bar/s;
// å¦ä¸€ç§å†™æ³•
// const re = new RegExp('foo.bar', 's');

re.test('foo\nbar') // true
re.dotAll // true
re.flags // 's'

```

### åé¡¾(åè¡Œæ–­è¨€)

ä¹‹å‰çš„ESåªæ”¯æŒå‰ç»(å…ˆè¡Œæ–­è¨€)ï¼ŒES2018 å¼•å…¥åé¡¾(åè¡Œæ–­è¨€)ï¼ŒV8 å¼•æ“ 4.9 ç‰ˆï¼ˆChrome 62ï¼‰å·²ç»æ”¯æŒã€‚

```js
// å‰ç»

// æ­£å‘å‰ç»
let r1 = /(?=y)x/ // x ä¹‹åæ˜¯ y æ‰åŒ¹é…å‡º x
// è´Ÿå‘å‰ç»
let r2 = /(?!y)x/ // x ä¹‹åä¸æ˜¯ y æ‰åŒ¹é…å‡º x

// åé¡¾

// æ­£å‘åé¡¾
let r3 = /(?<=y)x/ // x ä¹‹å‰æ˜¯ y æ‰åŒ¹é…å‡º x

// è´Ÿå‘åé¡¾
let r4 = /(?<=y)x/ // x ä¹‹å‰ä¸æ˜¯ y æ‰åŒ¹é…å‡º x

```

â€œåé¡¾â€çš„å®ç°ï¼Œéœ€è¦å…ˆåŒ¹é… `/(?<=y)x/` çš„ `x`ï¼Œç„¶åå†å›åˆ°å·¦è¾¹ï¼ŒåŒ¹é… `y` çš„éƒ¨åˆ†ã€‚è¿™ç§â€œå…ˆå³åå·¦â€çš„æ‰§è¡Œé¡ºåºï¼Œä¸æ‰€æœ‰å…¶ä»–æ­£åˆ™æ“ä½œç›¸åï¼Œå¯¼è‡´äº†ä¸€äº›ä¸ç¬¦åˆé¢„æœŸçš„è¡Œä¸ºã€‚

> åè¡Œæ–­è¨€æ˜¯å…ˆä»å·¦åˆ°å³æ‰«æï¼Œå‘ç°åŒ¹é…ä»¥åå†å›è¿‡å¤´ï¼Œä»å³åˆ°å·¦å®Œæˆåæ–œæ å¼•ç”¨ã€‚

- å¼‚å¸¸çš„ç»„åŒ¹é…

    ```ts
    // æ­£å¸¸çš„åˆ†ç»„åŒ¹é…
    /^(\d+)(\d+)$/.exec('1053'); // ['1053', '105', '3']
    // '1053' æ˜¯æ•´ä¸ªè¡¨è¾¾å¼åŒ¹é…ç»“æœ, '105' å’Œ '3' æ˜¯ä¸¤ä¸ªæ‹¬å·åˆ†ç»„åŒ¹é…ç»“æœ
    // ç¬¬ä¸€ä¸ªåˆ†ç»„åŒ¹é… '105' ï¼Œå› ä¸ºæ˜¯ è´ªå©ªæ¨¡å¼ï¼ŒåŒ¹é…å°½å¯èƒ½å¤š
    // ç¬¬äºŒä¸ªåˆ†ç»„åªåŒ¹é…åˆ°äº†å‰©ä¸‹çš„ä¸€ä¸ªå­—ç¬¦


    // æœ‰åé¡¾çš„åˆ†ç»„åŒ¹é…
    /(?<=(\d+)(\d+))$/.exec('105Â·3'); // ['', '1', '053']
    // '' è¡¨ç¤ºæ•´ä¸ªè¡¨è¾¾å¼æ²¡æœ‰åŒ¹é…åˆ°å­—ç¬¦ï¼Œ'1' å’Œ '053' æ˜¯ä¸¤ä¸ªæ‹¬å·åˆ†ç»„åŒ¹é…ç»“æœ
    // ç”±äºåé¡¾çš„æ‰§è¡Œé¡ºåºæ˜¯ä»å³åˆ°å·¦ï¼Œç¬¬äºŒä¸ªæ‹¬å·å…ˆåŒ¹é…ï¼Œå¹¶ä»¥è´ªå©ªæ¨¡å¼åŒ¹é…åˆ° '053'
    // ç¬¬ä¸€ä¸ªæ‹¬å·åªèƒ½åŒ¹é…åˆ° '1'

    ```

- å¼‚å¸¸çš„åæ–œæ å¼•ç”¨
ä¸é€šå¸¸çš„é¡ºåºç›¸åï¼Œå¿…é¡»æ”¾åœ¨å¯¹åº”çš„é‚£ä¸ªæ‹¬å·ä¹‹å‰ã€‚

    ```ts
    // æ­£å¸¸çš„åæ–œæ å¼•ç”¨
    /(12)(34)\1/  // è¡¨ç¤º 123412, \1 è¡¨ç¤ºç¬¬ä¸€ä¸ªåˆ†ç»„ 12
    /(12)(34)\2/  // è¡¨ç¤º 123434, \2 è¡¨ç¤ºç¬¬äºŒä¸ªåˆ†ç»„ 34
    /(12)(34)\1\2/  // è¡¨ç¤º 12341234
    /(12)(34)\2\1/  // è¡¨ç¤º 12343412

    // å¼‚å¸¸çš„åæ–œæ å¼•ç”¨
    console.log(/(?<=(o)pp\1)site/.exec('opposite')) // nullï¼Œ\1 åœ¨åˆ†ç»„ 1 æ‹¬å·å³è¾¹æ— æ³•åŒ¹é…
    console.log(/(?<=\1pp(o))site/.exec('opposite')) // ['site']ï¼Œ\1 åœ¨åˆ†ç»„ 1 æ‹¬å·å·¦è¾¹å¯ä»¥

    ```

### æ­£åˆ™çš„ Unicode å±æ€§ç±»

ES2018 å¼•å…¥äº†ä¸€ç§æ–°çš„ç±»çš„å†™æ³• `\p{...}` å’Œ `\P{...}`ï¼Œå…è®¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ç¬¦åˆ Unicode æŸç§å±æ€§çš„æ‰€æœ‰å­—ç¬¦ã€‚

å¤§å†™çš„P `\P{â€¦}` æ˜¯ å°å†™p `\p{â€¦}` çš„åå‘åŒ¹é…ï¼Œå³åŒ¹é…ä¸æ»¡è¶³æ¡ä»¶çš„å­—ç¬¦ã€‚
è¯­æ³•ï¼š

```ts

// é€šå¸¸ï¼ŒUnicode å±æ€§ç±»è¦æŒ‡å®šå±æ€§åå’Œå±æ€§å€¼ã€‚
/\p{UnicodePropertyName=UnicodePropertyValue}/u


// å¯¹äºæŸäº›å±æ€§ï¼Œå¯ä»¥åªå†™å±æ€§åï¼Œæˆ–è€…åªå†™å±æ€§å€¼ã€‚
/\p{UnicodePropertyName}/u
/\p{UnicodePropertyValue}/u

```

> è¿™ä¸¤ç§ç±»åªå¯¹ `Unicode` æœ‰æ•ˆï¼Œæ‰€ä»¥ä½¿ç”¨çš„æ—¶å€™ä¸€å®šè¦åŠ ä¸Š `u` ä¿®é¥°ç¬¦ã€‚å¦‚æœä¸åŠ  `u` ä¿®é¥°ç¬¦ï¼Œæ­£åˆ™è¡¨è¾¾å¼ä½¿ç”¨ `\p` å’Œ `\P` ä¼šæŠ¥é”™ï¼ŒECMAScript é¢„ç•™äº†è¿™ä¸¤ä¸ªç±»ã€‚

```js
// åŒ¹é…åè¿›åˆ¶æ•°å­—
const regex = /^\p{Decimal_Number}+$/u;
regex.test('ğŸğŸğŸ‘ğŸœğŸğŸğŸ©ğŸªğŸ«ğŸ¬ğŸ­ğŸ®ğŸ¯ğŸºğŸ»ğŸ¼') // true

// åŒ¹é…æ‰€æœ‰æ•°å­—
const regex = /^\p{Number}+$/u;
regex.test('Â²Â³Â¹Â¼Â½Â¾') // true
regex.test('ã‰›ã‰œã‰') // true
regex.test('â… â…¡â…¢â…£â…¤â…¥â…¦â…§â…¨â…©â…ªâ…«') // true

// åŒ¹é…æ‰€æœ‰ç©ºæ ¼
\p{White_Space}

// åŒ¹é…å„ç§æ–‡å­—çš„æ‰€æœ‰å­—æ¯ï¼Œç­‰åŒäº Unicode ç‰ˆçš„ \w
[\p{Alphabetic}\p{Mark}\p{Decimal_Number}\p{Connector_Punctuation}\p{Join_Control}]

// åŒ¹é…å„ç§æ–‡å­—çš„æ‰€æœ‰éå­—æ¯çš„å­—ç¬¦ï¼Œç­‰åŒäº Unicode ç‰ˆçš„ \W
[^\p{Alphabetic}\p{Mark}\p{Decimal_Number}\p{Connector_Punctuation}\p{Join_Control}]

// åŒ¹é… Emoji
/\p{Emoji_Modifier_Base}\p{Emoji_Modifier}?|\p{Emoji_Presentation}|\p{Emoji}\uFE0F/gu

// åŒ¹é…æ‰€æœ‰çš„ç®­å¤´å­—ç¬¦
const regexArrows = /^\p{Block=Arrows}+$/u;
regexArrows.test('â†â†‘â†’â†“â†”â†•â†–â†—â†˜â†™â‡â‡â‡‘â‡’â‡“â‡”â‡•â‡–â‡—â‡˜â‡™â‡§â‡©') // true

```

### å…·åç»„åŒ¹é… -- æ‹¥æœ‰åˆ«åçš„åˆ†ç»„åŒ¹é…

ä½¿ç”¨ `?<ç»„å>` å†™æ³•

```js
// æ²¡æœ‰åˆ†ç»„åçš„æ­£åˆ™

let result = /(\d{4})-(\d{2})-(\d{2})/.exec('1999-12-31') // 3 ä¸ªåˆ†ç»„ä¸å¸¦åå­—
/*
[ '1999-12-31',
  '1999', // åˆ†ç»„ 1 åŒ¹é…ç»“æœ
  '12', // åˆ†ç»„ 2 åŒ¹é…ç»“æœ
  '31', // åˆ†ç»„ 3 åŒ¹é…ç»“æœ
  index: 0,
  input: '1999-12-31',
  groups: undefined
]
*/
// éœ€è¦ä½¿ç”¨åˆ†ç»„åŒ¹é…çš„ç»“æœæ—¶ï¼Œå¿…é¡»æŒ‰ä¸‹æ ‡é¡ºåºè®¿é—®ï¼Œå¦‚æœåˆ†ç»„é¡ºåºå˜åŒ–ï¼Œè®¿é—®ä¹Ÿéœ€è¦å˜åŒ–
console.log(
    result[1], // 1999
    result[2], // 12
    result[3] // 31
)


```

> ç»„åŒ¹é…çš„ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œæ¯ä¸€ç»„çš„åŒ¹é…å«ä¹‰ä¸å®¹æ˜“çœ‹å‡ºæ¥ï¼Œè€Œä¸”åªèƒ½ç”¨æ•°å­—åºå·ï¼ˆæ¯”å¦‚matchObj[1]ï¼‰å¼•ç”¨ï¼Œè¦æ˜¯ç»„çš„é¡ºåºå˜äº†ï¼Œå¼•ç”¨çš„æ—¶å€™å°±å¿…é¡»ä¿®æ”¹åºå·ã€‚
> ES2018 å¼•å…¥äº†å…·åç»„åŒ¹é…ï¼ˆNamed Capture Groupsï¼‰ï¼Œå…è®¸ä¸ºæ¯ä¸€ä¸ªç»„åŒ¹é…æŒ‡å®šä¸€ä¸ªåå­—ï¼Œæ—¢ä¾¿äºé˜…è¯»ä»£ç ï¼Œåˆä¾¿äºå¼•ç”¨ã€‚

```js
let result = /(?<year>\d{4})-(?<month>\d{2})-(?<day>\d{2})/.exec('1999-12-31')
/*
[ '1999-12-31',
  '1999',
  '12',
  '31',
  index: 0,
  input: '1999-12-31',
  groups: { year: '1999', month: '12', day: '31' }
]
*/

// éœ€è¦ä½¿ç”¨åˆ†ç»„åŒ¹é…çš„ç»“æœæ—¶ï¼Œç›´æ¥è®¿é—® groups å¯¹è±¡å³å¯ï¼Œåˆ†ç»„é¡ºåºå˜åŒ–ä¹Ÿä¸ä¼šå½±å“ä½¿ç”¨ï¼
// å½“ç„¶ï¼Œä¹Ÿè¿˜å¯ä»¥ç»§ç»­é€šè¿‡æ•°ç»„ä¸‹æ ‡ result[1] è¿™æ ·çš„æ–¹å¼è·å–
console.log(
  result.groups.year, // 1999
  result.groups.month, // 12
  result.groups.day // 31
)

```

###### å³ä½¿åˆ†ç»„æ²¡æœ‰åŒ¹é…åˆ°ç»“æœï¼Œåˆ†ç»„åå­—ä¹Ÿä¼šå­˜åœ¨äº groups å¯¹è±¡çš„ key ä¸­ï¼Œå€¼ä¸º `undefined`

##### å…·ååˆ†ç»„çš„è§£æ„èµ‹å€¼å’Œæ›¿æ¢

```js
// è§£æ„èµ‹å€¼ä½¿ç”¨åˆ†ç»„ç»“æœ
let {groups: {year, month}} = /(?<year>\d{4})-(?<month>\d{2})-(?<day>\d{2})/.exec('1999-12-31')
console.log(year, month) // 1999 12

// ä½¿ç”¨åˆ†ç»„åæ›¿æ¢
let r = /(?<year>\d{4})-(?<month>\d{2})-(?<day>\d{2})/u
'1999-12-31'.replace(r, '$<day>/$<month>/$<year>') // "31/12/1999"

// å‡½æ•°æ›¿æ¢

let changed = '1999-12-31'.replace(r, change)
console.log(changed) // 31/12/1999

function change (
  matched, // æ•´ä¸ªåŒ¹é…ç»“æœ
  capture1, // ç¬¬ä¸€ä¸ªç»„åŒ¹é…
  capture2, // ç¬¬äºŒä¸ªç»„åŒ¹é…
  capture3, // ç¬¬ä¸‰ä¸ªç»„åŒ¹é…
  position, // åŒ¹é…å¼€å§‹çš„ä½ç½®
  S, // åŸå­—ç¬¦ä¸²
  groups // å…·åç»„æ„æˆçš„ä¸€ä¸ªå¯¹è±¡ {year, month, day}
) {
  let {day, month, year} = groups;
  return `${day}/${month}/${year}`;
}


```

##### æ­£åˆ™è¡¨è¾¾å¼å†…å¼•ç”¨åˆ†ç»„å

ä½¿ç”¨ `\k<ç»„å>` çš„å†™æ³•ï¼Œ æ•°å­—å¼•ç”¨ï¼ˆ\1ï¼‰ä¾ç„¶æœ‰æ•ˆã€‚ä¸¤ç§å¼•ç”¨è¯­æ³•è¿˜å¯ä»¥åŒæ—¶ä½¿ç”¨ã€‚

```js
// å¼•ç”¨åˆ†ç»„å
let r = /^(?<word>[a-z]+)!\k<word>$/
r.test('abc!abc') // true
r.test('abc!ab') // false

// æ•°å­—å¼•ç”¨
const RE_TWICE = /^(?<word>[a-z]+)!\1$/;
RE_TWICE.test('abc!abc') // true
RE_TWICE.test('abc!ab') // false


// åŒæ—¶ä½¿ç”¨ åˆ†ç»„åå¼•ç”¨ å’Œ æ•°å­—å¼•ç”¨
const RE_TWICE = /^(?<word>[a-z]+)!\k<word>!\1$/;
RE_TWICE.test('abc!abc!abc') // true
RE_TWICE.test('abc!abc!ab') // false
```

### String.prototype.matchAll

å–å‡ºä¸€ä¸ªå­—ç¬¦ä¸²ä¸­çš„å¤šä¸ªåŒ¹é…ç»“æœ

- ä¹‹å‰çš„æ–¹æ³•ï¼šä½¿ç”¨ `ä¿®é¥°ç¬¦g` æˆ– `ä¿®é¥°ç¬¦y`  

    ```js
    let regex = /t(e)(st(\d?))/g
    let str = 'test1test2test3'

    let matches = []
    let match
    while (match = regex.exec(str)) {
      matches.push(match) // å¾ªç¯å–å‡ºæ¯ä¸€è½®çš„æ­£åˆ™åŒ¹é…ï¼Œå¹¶æ”¾å…¥æ•°ç»„ä¸­
    }
    console.log(matches)
    /*
    [
        ["test1", "e", "st1", "1", index: 0, input: "test1test2test3", groups: undefined]
        ["test2", "e", "st2", "2", index: 5, input: "test1test2test3", groups: undefined]
        ["test3", "e", "st3", "3", index: 10, input: "test1test2test3", groups: undefined]
    ]
    */


    ```

- String æ–°ææ¡ˆæ–¹æ³•ï¼š`String.prototype.matchAll`  
  ä¸€æ¬¡æ€§å–å‡ºæ‰€æœ‰åŒ¹é…ã€‚è¿”å›çš„ä¸€ä¸ªéå†å™¨ï¼ˆIteratorï¼‰ï¼Œè€Œä¸æ˜¯æ•°ç»„ã€‚

    ```js
    let regex = /t(e)(st(\d?))/g // g ä¿®é¥°ç¬¦åŠ ä¸åŠ éƒ½å¯ä»¥
    let str = 'test1test2test3'

    let matches = str.matchAll(regex)
    let match
    for (const match of matches) {
      console.log(match)
    }
    // ["test1", "e", "st1", "1", index: 0, input: "test1test2test3"]
    // ["test2", "e", "st2", "2", index: 5, input: "test1test2test3"]
    // ["test3", "e", "st3", "3", index: 10, input: "test1test2test3"]
    console.log(match)
    console.log(typeof match)
    console.log(Object.prototype.toString.call(match))

    ```

    ```js

    for (const match of string.matchAll(regex)) {
      console.log(match);
    }
    // ["test1", "e", "st1", "1", index: 0, input: "test1test2test3"]
    // ["test2", "e", "st2", "2", index: 5, input: "test1test2test3"]
    // ["test3", "e", "st3", "3", index: 10, input: "test1test2test3"]

    ```

ç”±äºstring.matchAll(regex)è¿”å›çš„æ˜¯éå†å™¨ï¼Œæ‰€ä»¥å¯ä»¥ç”¨for...ofå¾ªç¯å–å‡ºã€‚ç›¸å¯¹äºè¿”å›æ•°ç»„ï¼Œè¿”å›éå†å™¨çš„å¥½å¤„åœ¨äºï¼Œå¦‚æœåŒ¹é…ç»“æœæ˜¯ä¸€ä¸ªå¾ˆå¤§çš„æ•°ç»„ï¼Œé‚£ä¹ˆéå†å™¨æ¯”è¾ƒèŠ‚çœèµ„æºã€‚

éå†å™¨è½¬ä¸ºæ•°ç»„æ˜¯éå¸¸ç®€å•çš„ï¼Œä½¿ç”¨...è¿ç®—ç¬¦å’ŒArray.fromæ–¹æ³•å°±å¯ä»¥äº†ã€‚

```js
// è½¬ä¸ºæ•°ç»„æ–¹æ³•ä¸€
[...string.matchAll(regex)]

// è½¬ä¸ºæ•°ç»„æ–¹æ³•äºŒ
Array.from(string.matchAll(regex));

```

## æ•°å€¼çš„æ‰©å±•

- äºŒè¿›åˆ¶å’Œå…«è¿›åˆ¶è¡¨ç¤ºæ³•
- Number.isFinite(), Number.isNaN()
- Number.parseInt(), Number.parseFloat()
- Number.isInteger()
- Number.EPSILON
- å®‰å…¨æ•´æ•°å’Œ Number.isSafeInteger()
- Math å¯¹è±¡çš„æ‰©å±•
- æŒ‡æ•°è¿ç®—ç¬¦

### äºŒè¿›åˆ¶å’Œå…«è¿›åˆ¶è¡¨ç¤ºæ³•

ES6 æä¾›äº†äºŒè¿›åˆ¶å’Œå…«è¿›åˆ¶æ•°å€¼çš„æ–°çš„å†™æ³•ï¼Œåˆ†åˆ«ç”¨å‰ç¼€ `0b`ï¼ˆæˆ– `0B` ï¼‰å’Œ `0o` ï¼ˆæˆ– `0O` ï¼‰è¡¨ç¤ºã€‚

ä» ES5 å¼€å§‹ï¼Œåœ¨ä¸¥æ ¼æ¨¡å¼ä¹‹ä¸­ï¼Œå…«è¿›åˆ¶å°±ä¸å†å…è®¸ä½¿ç”¨å‰ç¼€ `0` è¡¨ç¤ºï¼ŒES6 è¿›ä¸€æ­¥æ˜ç¡®ï¼Œè¦ä½¿ç”¨å‰ç¼€ `0o`   è¡¨ç¤ºã€‚

```js
0b111110111 === 503 // true // äºŒè¿›åˆ¶
0o767 === 503 // true å…«è¿›åˆ¶

```

å°†0bå’Œ0oå‰ç¼€çš„å­—ç¬¦ä¸²æ•°å€¼è½¬ä¸ºåè¿›åˆ¶ï¼Œè¦ä½¿ç”¨Numberæ–¹æ³•ã€‚

```js
Number('0b111')  // 7
Number('0o10')  // 8

```

### Number.isFinite(), Number.isNaN()

ES6 åœ¨ `Number` å¯¹è±¡ä¸Šï¼Œæ–°æä¾›äº† `Number.isFinite()` å’Œ `Number.isNaN()` ä¸¤ä¸ªæ–¹æ³•ã€‚

`Number.isFinite()` ç”¨æ¥æ£€æŸ¥ä¸€ä¸ªæ•°å€¼æ˜¯å¦ä¸ºæœ‰é™çš„ï¼ˆfiniteï¼‰ï¼Œå³ä¸æ˜¯ `Infinity` ã€‚
> æ³¨æ„ï¼Œå¦‚æœå‚æ•°ç±»å‹ä¸æ˜¯æ•°å€¼ï¼ŒNumber.isFiniteä¸€å¾‹è¿”å›falseã€‚

```js
Number.isFinite(15); // true
Number.isFinite(0.8); // true
Number.isFinite(NaN); // false
Number.isFinite(Infinity); // false
Number.isFinite(-Infinity); // false
Number.isFinite('foo'); // false
Number.isFinite('15'); // false
Number.isFinite(true); // false

```

`Number.isNaN()` ç”¨æ¥æ£€æŸ¥ä¸€ä¸ªå€¼æ˜¯å¦ä¸º `NaN` ã€‚
> å¦‚æœå‚æ•°ç±»å‹ä¸æ˜¯NaNï¼ŒNumber.isNaNä¸€å¾‹è¿”å›falseã€‚

##### ä¸å…¨å±€æ–¹æ³•`isFinite()`å’Œ`isNaN()`çš„åŒºåˆ«  

- ä¼ ç»Ÿæ–¹æ³•å…ˆè°ƒç”¨Number()å°†éæ•°å€¼çš„å€¼è½¬ä¸ºæ•°å€¼ï¼Œå†è¿›è¡Œåˆ¤æ–­
- Number çš„è¿™ä¸¤ä¸ªæ–°æ–¹æ³•åªå¯¹æ•°å€¼åšæœ‰æ•ˆåˆ¤æ–­ï¼Œéæ•°å€¼ä¸€å¾‹ `false`ï¼Œæ˜¯æ•°å€¼åˆ™æ­£å¸¸åˆ¤æ–­ã€‚

```
isFinite(25) // true
isFinite("25") // true
Number.isFinite(25) // true
Number.isFinite("25") // false

isNaN(NaN) // true
isNaN("NaN") // true
Number.isNaN(NaN) // true
Number.isNaN("NaN") // false
Number.isNaN(1) // false

```

### Number.parseInt(), Number.parseFloat()

ES6 å°†å…¨å±€æ–¹æ³•parseInt()å’ŒparseFloat()ï¼Œç§»æ¤åˆ°Numberå¯¹è±¡ä¸Šé¢ï¼Œè¡Œä¸ºå®Œå…¨ä¿æŒä¸å˜ã€‚
è¿™æ ·åšçš„ç›®çš„ï¼Œæ˜¯é€æ­¥å‡å°‘å…¨å±€æ€§æ–¹æ³•ï¼Œä½¿å¾—è¯­è¨€é€æ­¥æ¨¡å—åŒ–ã€‚

```
Number.parseInt === parseInt // true
Number.parseFloat === parseFloat // true

// ES5çš„å†™æ³•
parseInt('12.34') // 12
parseFloat('123.45#') // 123.45

// ES6çš„å†™æ³•
Number.parseInt('12.34') // 12
Number.parseFloat('123.45#') // 123.45
```

### Number.isInteger()

Number.isInteger()ç”¨æ¥åˆ¤æ–­ä¸€ä¸ªæ•°å€¼æ˜¯å¦ä¸ºæ•´æ•°ã€‚
JavaScript å†…éƒ¨ï¼Œæ•´æ•°å’Œæµ®ç‚¹æ•°é‡‡ç”¨çš„æ˜¯åŒæ ·çš„å‚¨å­˜æ–¹æ³•ï¼Œæ‰€ä»¥ 25 å’Œ 25.0 è¢«è§†ä¸ºåŒä¸€ä¸ªå€¼ã€‚
å¦‚æœå‚æ•°ä¸æ˜¯æ•°å€¼ï¼ŒNumber.isIntegerè¿”å›falseã€‚

> æ³¨æ„ï¼Œç”±äº JavaScript é‡‡ç”¨ IEEE 754 æ ‡å‡†ï¼Œæ•°å€¼å­˜å‚¨ä¸º64ä½åŒç²¾åº¦æ ¼å¼ï¼Œæ•°å€¼ç²¾åº¦æœ€å¤šå¯ä»¥è¾¾åˆ° 53 ä¸ªäºŒè¿›åˆ¶ä½ï¼ˆ1 ä¸ªéšè—ä½ä¸ 52 ä¸ªæœ‰æ•ˆä½ï¼‰ã€‚å¦‚æœæ•°å€¼çš„ç²¾åº¦è¶…è¿‡è¿™ä¸ªé™åº¦ï¼Œç¬¬54ä½åŠåé¢çš„ä½å°±ä¼šè¢«ä¸¢å¼ƒï¼Œè¿™ç§æƒ…å†µä¸‹ï¼ŒNumber.isIntegerå¯èƒ½ä¼šè¯¯åˆ¤ã€‚

```js
Number.isInteger(25) // true
Number.isInteger(25.1) // false

Number.isInteger(25) // true
Number.isInteger(25.0) // true

Number.isInteger() // false
Number.isInteger(null) // false
Number.isInteger('15') // false
Number.isInteger(true) // false

// Number.isIntegerçš„å‚æ•°æ˜æ˜ä¸æ˜¯æ•´æ•°ï¼Œä½†æ˜¯ä¼šè¿”å›trueã€‚
// åŸå› å°±æ˜¯è¿™ä¸ªå°æ•°çš„ç²¾åº¦è¾¾åˆ°äº†å°æ•°ç‚¹å16ä¸ªåè¿›åˆ¶ä½ï¼Œè½¬æˆäºŒè¿›åˆ¶ä½è¶…è¿‡äº†53ä¸ªäºŒè¿›åˆ¶ä½ï¼Œå¯¼è‡´æœ€åçš„é‚£ä¸ª2è¢«ä¸¢å¼ƒäº†ã€‚
Number.isInteger(3.0000000000000002) // true

// ä¸€ä¸ªæ•°å€¼çš„ç»å¯¹å€¼å°äº Number.MIN_VALUEï¼ˆ5E-324ï¼‰ï¼Œå³å°äº JavaScript èƒ½å¤Ÿåˆ†è¾¨çš„æœ€å°å€¼ï¼Œä¼šè¢«è‡ªåŠ¨è½¬ä¸º 0ã€‚è¿™æ—¶ï¼ŒNumber.isIntegerä¹Ÿä¼šè¯¯åˆ¤ã€‚
Number.isInteger(5E-324) // false
Number.isInteger(5E-325) // trueï¼Œ5E-325ç”±äºå€¼å¤ªå°ï¼Œä¼šè¢«è‡ªåŠ¨è½¬ä¸º0ï¼Œå› æ­¤è¿”å›trueã€‚
```

æ€»ä¹‹ï¼Œå¦‚æœå¯¹æ•°æ®ç²¾åº¦çš„è¦æ±‚è¾ƒé«˜ï¼Œä¸å»ºè®®ä½¿ç”¨ `Number.isInteger()` åˆ¤æ–­ä¸€ä¸ªæ•°å€¼æ˜¯å¦ä¸ºæ•´æ•°ã€‚

### Number.EPSILON

JavaScript èƒ½å¤Ÿè¡¨ç¤ºçš„æœ€å°ç²¾åº¦ã€‚è¯¯å·®å¦‚æœå°äºè¿™ä¸ªå€¼ï¼Œå°±å¯ä»¥è®¤ä¸ºå·²ç»æ²¡æœ‰æ„ä¹‰äº†ï¼Œå³ä¸å­˜åœ¨è¯¯å·®äº†ã€‚

å€¼ä¸º 1 ä¸å¤§äº 1 çš„æœ€å°æµ®ç‚¹æ•°ä¹‹é—´çš„å·®ã€‚å¯¹äº 64 ä½æµ®ç‚¹æ•°æ¥è¯´ï¼Œå¤§äº 1 çš„æœ€å°æµ®ç‚¹æ•°ç›¸å½“äºäºŒè¿›åˆ¶çš„1.00..001ï¼Œå°æ•°ç‚¹åé¢æœ‰è¿ç»­ 51 ä¸ªé›¶ã€‚è¿™ä¸ªå€¼å‡å» 1 ä¹‹åï¼Œå°±ç­‰äº 2 çš„ -52 æ¬¡æ–¹ã€‚

```js
Number.EPSILON === Math.pow(2, -52)
// true
Number.EPSILON
// 2.220446049250313e-16
Number.EPSILON.toFixed(20)
// "0.00000000000000022204"
```

#### ä½œç”¨

`Number.EPSILON` å¯ä»¥ç”¨æ¥è®¾ç½®â€œèƒ½å¤Ÿæ¥å—çš„è¯¯å·®èŒƒå›´â€ã€‚æ¯”å¦‚ï¼Œè¯¯å·®èŒƒå›´è®¾ä¸º 2 çš„-50 æ¬¡æ–¹ï¼ˆå³ `Number.EPSILON * Math.pow(2, 2)` ï¼‰ï¼Œå³å¦‚æœä¸¤ä¸ªæµ®ç‚¹æ•°çš„å·®å°äºè¿™ä¸ªå€¼ï¼Œæˆ‘ä»¬å°±è®¤ä¸ºè¿™ä¸¤ä¸ªæµ®ç‚¹æ•°ç›¸ç­‰ã€‚

```js
5.551115123125783e-17 < Number.EPSILON * Math.pow(2, 2) // true

// å°è£…ä¸€ä¸ªå‡½æ•°ï¼Œåˆ¤æ–­ä¸¤ä¸ªæ•°çš„è¯¯å·®æ˜¯å¦åœ¨å…è®¸èŒƒå›´ä¹‹å†…ï¼Œæ­¤å¤„å…è®¸èŒƒå›´æ˜¯ 2 çš„ -30 æ¬¡æ–¹ (2e-52 * 2e-22)
function withinErrorMargin (left, right) {
  return Math.abs(left - right) < Number.EPSILON * Math.pow(2, 22);
}

console.log(0.1 + 0.2 === 0.3) // false
console.log(withinErrorMargin(0.1 + 0.2, 0.3)) // true

1.1 + 1.3 === 2.4 // false
withinErrorMargin(1.1 + 1.3, 2.4) // true
```

### å®‰å…¨æ•´æ•°å’Œ Number.isSafeInteger()

JavaScript èƒ½å¤Ÿå‡†ç¡®è¡¨ç¤ºçš„æ•´æ•°èŒƒå›´åœ¨-2^53åˆ°2^53ä¹‹é—´ï¼ˆä¸å«ä¸¤ä¸ªç«¯ç‚¹ï¼‰ï¼Œè¶…è¿‡è¿™ä¸ªèŒƒå›´ï¼Œæ— æ³•ç²¾ç¡®è¡¨ç¤ºè¿™ä¸ªå€¼ã€‚

```js
console.log(Math.pow(2, 53)) // 9007199254740992

// è¶…å‡º 2 çš„ 53 æ¬¡æ–¹ä¹‹åï¼Œä¸€ä¸ªæ•°å°±ä¸ç²¾ç¡®äº†ã€‚
console.log(9007199254740992)   // 9007199254740992
console.log(9007199254740993)   // 9007199254740992
console.log(9007199254740994)   // 9007199254740994
console.log(9007199254740995)   // 9007199254740996
console.log(90071992547409955)  // 90071992547409950

console.log(Math.pow(2, 53) === Math.pow(2, 53) + 1) // true

```

ES6 å¼•å…¥äº† `Number.MAX_SAFE_INTEGER` å’Œ `Number.MIN_SAFE_INTEGER` è¿™ä¸¤ä¸ªå¸¸é‡ï¼Œç”¨æ¥è¡¨ç¤ºè¿™ä¸ªèŒƒå›´çš„ä¸Šä¸‹é™ã€‚

```js
Number.MAX_SAFE_INTEGER === Math.pow(2, 53) - 1 // true
Number.MAX_SAFE_INTEGER === 9007199254740991 // true

Number.MIN_SAFE_INTEGER === -Number.MAX_SAFE_INTEGER // true
Number.MIN_SAFE_INTEGER === -9007199254740991 // true

```

`Number.isSafeInteger()` åˆ™æ˜¯ç”¨æ¥åˆ¤æ–­ä¸€ä¸ªæ•´æ•°æ˜¯å¦è½åœ¨è¿™ä¸ªèŒƒå›´ä¹‹å†…ã€‚

```js
Number.isSafeInteger('a') // false
Number.isSafeInteger(null) // false
Number.isSafeInteger(NaN) // false
Number.isSafeInteger(Infinity) // false
Number.isSafeInteger(-Infinity) // false

Number.isSafeInteger(3) // true
Number.isSafeInteger(1.2) // false
Number.isSafeInteger(9007199254740990) // true
Number.isSafeInteger(9007199254740992) // false

Number.isSafeInteger(Number.MIN_SAFE_INTEGER - 1) // false
Number.isSafeInteger(Number.MIN_SAFE_INTEGER) // true
Number.isSafeInteger(Number.MAX_SAFE_INTEGER) // true
Number.isSafeInteger(Number.MAX_SAFE_INTEGER + 1) // false
```

`Number.isSafeInteger()` å‡½æ•°çš„å®ç°

```js
Number.isSafeInteger = function (n) {
  return (typeof n === 'number' && // æ˜¯ number ç±»å‹
    Math.round(n) === n && // æ˜¯æ•´æ•°
    Number.MIN_SAFE_INTEGER <= n && // å¤§äº æœ€å°æ•´æ•°
    n <= Number.MAX_SAFE_INTEGER); // å°äºæœ€å¤§æ•´æ•°
}
```

> å®é™…ä½¿ç”¨è¿™ä¸ªå‡½æ•°æ—¶ï¼Œéœ€è¦æ³¨æ„ã€‚éªŒè¯è¿ç®—ç»“æœæ˜¯å¦è½åœ¨å®‰å…¨æ•´æ•°çš„èŒƒå›´å†…ï¼Œä¸è¦åªéªŒè¯è¿ç®—ç»“æœï¼Œè€Œè¦åŒæ—¶éªŒè¯å‚ä¸è¿ç®—çš„æ¯ä¸ªå€¼ã€‚

```js
Number.isSafeInteger(9007199254740993)
// false
Number.isSafeInteger(990)
// true
Number.isSafeInteger(9007199254740993 - 990)
// true
9007199254740993 - 990
// è¿”å›ç»“æœ 9007199254740002
// æœ¬åº”æ˜¯ 9007199254740003
```

9007199254740993ä¸æ˜¯ä¸€ä¸ªå®‰å…¨æ•´æ•°ï¼Œä½†æ˜¯Number.isSafeIntegerä¼šè¿”å›ç»“æœï¼Œæ˜¾ç¤ºè®¡ç®—ç»“æœæ˜¯å®‰å…¨çš„ã€‚è¿™æ˜¯å› ä¸ºï¼Œè¿™ä¸ªæ•°è¶…å‡ºäº†ç²¾åº¦èŒƒå›´ï¼Œå¯¼è‡´åœ¨è®¡ç®—æœºå†…éƒ¨ï¼Œä»¥9007199254740992çš„å½¢å¼å‚¨å­˜ã€‚

```js
9007199254740993 === 9007199254740992 // true

```

åŒæ—¶éªŒè¯ä¸¤ä¸ªè¿ç®—æ•°å’Œè¿ç®—ç»“æœçš„å‡½æ•°ï¼š

```js
function trusty (left, right, result) {
  if (
    Number.isSafeInteger(left) &&
    Number.isSafeInteger(right) &&
    Number.isSafeInteger(result)
  ) {
    return result;
  }
  throw new RangeError('Operation cannot be trusted!');
}

trusty(9007199254740993, 990, 9007199254740993 - 990)
// RangeError: Operation cannot be trusted!

trusty(1, 2, 3)
// 3

```

### Math å¯¹è±¡çš„æ‰©å±•

ES6 åœ¨ Math å¯¹è±¡ä¸Šæ–°å¢äº† 17 ä¸ªä¸æ•°å­¦ç›¸å…³çš„æ–¹æ³•ã€‚æ‰€æœ‰è¿™äº›æ–¹æ³•éƒ½æ˜¯é™æ€æ–¹æ³•ï¼Œåªèƒ½åœ¨ Math å¯¹è±¡ä¸Šè°ƒç”¨ã€‚

##### Math.trunc()

å»é™¤ä¸€ä¸ªæ•°çš„å°æ•°éƒ¨åˆ†ï¼Œè¿”å›æ•´æ•°éƒ¨åˆ†ã€‚å¯¹äºéæ•°å€¼ï¼ŒMath.truncå†…éƒ¨ä½¿ç”¨Numberæ–¹æ³•å°†å…¶å…ˆè½¬ä¸ºæ•°å€¼ã€‚å¯¹äºç©ºå€¼å’Œæ— æ³•æˆªå–æ•´æ•°çš„å€¼ï¼Œè¿”å›NaNã€‚

```js
Math.trunc(4.1) // 4
Math.trunc(4.9) // 4
Math.trunc(-4.1) // -4
Math.trunc(-4.9) // -4
Math.trunc(-0.1234) // -0

Math.trunc('123.456') // 123
Math.trunc(true) //1
Math.trunc(false) // 0
Math.trunc(null) // 0

Math.trunc(NaN);      // NaN
Math.trunc('foo');    // NaN
Math.trunc();         // NaN
Math.trunc(undefined) // NaN

Math.trunc = Math.trunc || function(x) {
  return x < 0 ? Math.ceil(x) : Math.floor(x);
};

```

##### Math.sign()

Math.signæ–¹æ³•ç”¨æ¥åˆ¤æ–­ä¸€ä¸ªæ•°åˆ°åº•æ˜¯æ­£æ•°ã€è´Ÿæ•°ã€è¿˜æ˜¯é›¶ã€‚

å¯¹äºéæ•°å€¼ï¼Œä¼šä½¿ç”¨ `Number(x)` å…ˆå°†å…¶è½¬æ¢ä¸ºæ•°å€¼ã€‚èƒ½è½¬åˆ™è½¬åè¿”å›ç»“æœï¼Œè½¬ä¸äº†åˆ™è¿”å›NaN

å®ƒä¼šè¿”å›äº”ç§å€¼ã€‚

- å‚æ•°ä¸ºæ­£æ•°ï¼Œè¿”å›+1ï¼›
- å‚æ•°ä¸ºè´Ÿæ•°ï¼Œè¿”å›-1ï¼›
- å‚æ•°ä¸º 0ï¼Œè¿”å›0ï¼›
- å‚æ•°ä¸º-0ï¼Œè¿”å›-0;
- å…¶ä»–å€¼ï¼Œè¿”å›NaNã€‚

```js
Math.sign(-5) // -1
Math.sign(5) // +1
Math.sign(0) // +0
Math.sign(-0) // -0
Math.sign(NaN) // NaN

Math.sign('')  // 0
Math.sign(true)  // +1
Math.sign(false)  // 0
Math.sign(null)  // 0
Math.sign('9')  // +1
Math.sign('foo')  // NaN
Math.sign()  // NaN
Math.sign(undefined)  // NaN

// å¯¹äºæ²¡æœ‰éƒ¨ç½²è¿™ä¸ªæ–¹æ³•çš„ç¯å¢ƒï¼Œå¯ä»¥ç”¨ä¸‹é¢çš„ä»£ç æ¨¡æ‹Ÿã€‚
Math.sign = Math.sign || function(x) {
  x = +x; // convert to a number
  if (x === 0 || isNaN(x)) {
    return x;
  }
  return x > 0 ? 1 : -1;
}

```

##### Math.cbrt()

Math.cbrtæ–¹æ³•ç”¨äºè®¡ç®—ä¸€ä¸ªæ•°çš„ç«‹æ–¹æ ¹ã€‚

```js
Math.cbrt(-1) // -1
Math.cbrt(0)  // 0
Math.cbrt(1)  // 1
Math.cbrt(2)  // 1.2599210498948734

// å¯¹äºéæ•°å€¼ï¼ŒMath.cbrtæ–¹æ³•å†…éƒ¨ä¹Ÿæ˜¯å…ˆä½¿ç”¨Numberæ–¹æ³•å°†å…¶è½¬ä¸ºæ•°å€¼ã€‚
Math.cbrt('8') // 2
Math.cbrt('hello') // NaN

// å¯¹äºæ²¡æœ‰éƒ¨ç½²è¿™ä¸ªæ–¹æ³•çš„ç¯å¢ƒï¼Œå¯ä»¥ç”¨ä¸‹é¢çš„ä»£ç æ¨¡æ‹Ÿã€‚
Math.cbrt = Math.cbrt || function(x) {
  var y = Math.pow(Math.abs(x), 1/3);
  return x < 0 ? -y : y;
};

```

##### Math.clz32()

`Math.clz32()` æ–¹æ³•å°†å‚æ•°è½¬ä¸º 32 ä½æ— ç¬¦å·æ•´æ•°çš„å½¢å¼ï¼Œç„¶åè¿”å›è¿™ä¸ª 32 ä½å€¼é‡Œé¢æœ‰å¤šå°‘ä¸ªå‰å¯¼ 0ã€‚  

clz32è¿™ä¸ªå‡½æ•°åå°±æ¥è‡ªâ€count leading zero bits in 32-bit binary representation of a numberâ€œï¼ˆè®¡ç®—ä¸€ä¸ªæ•°çš„ 32 ä½äºŒè¿›åˆ¶å½¢å¼çš„å‰å¯¼ 0 çš„ä¸ªæ•°ï¼‰çš„ç¼©å†™ã€‚

```js
Math.clz32(0) // 32
Math.clz32(1) // 31
Math.clz32(1000) // 22
Math.clz32(0b01000000000000000000000000000000) // 1
Math.clz32(0b00100000000000000000000000000000) // 2
// ä¸Šé¢ä»£ç ä¸­ï¼Œ0 çš„äºŒè¿›åˆ¶å½¢å¼å…¨ä¸º 0ï¼Œæ‰€ä»¥æœ‰ 32 ä¸ªå‰å¯¼ 0ï¼›
// 1 çš„äºŒè¿›åˆ¶å½¢å¼æ˜¯0b1ï¼Œåªå  1 ä½ï¼Œæ‰€ä»¥ 32 ä½ä¹‹ä¸­æœ‰ 31 ä¸ªå‰å¯¼ 0ï¼›
// 1000 çš„äºŒè¿›åˆ¶å½¢å¼æ˜¯0b1111101000ï¼Œä¸€å…±æœ‰ 10 ä½ï¼Œæ‰€ä»¥ 32 ä½ä¹‹ä¸­æœ‰ 22 ä¸ªå‰å¯¼ 0ã€‚


// å·¦ç§»è¿ç®—ç¬¦ï¼ˆ<<ï¼‰ä¸Math.clz32æ–¹æ³•ç›´æ¥ç›¸å…³ã€‚
Math.clz32(0) // 32
Math.clz32(1) // 31
Math.clz32(1 << 1) // 30
Math.clz32(1 << 2) // 29
Math.clz32(1 << 29) // 2

// å¯¹äºå°æ•°ï¼ŒMath.clz32æ–¹æ³•åªè€ƒè™‘æ•´æ•°éƒ¨åˆ†ã€‚
Math.clz32(3.2) // 30
Math.clz32(3.9) // 30

// å¯¹äºç©ºå€¼æˆ–å…¶ä»–ç±»å‹çš„å€¼ï¼ŒMath.clz32æ–¹æ³•ä¼šå°†å®ƒä»¬å…ˆè½¬ä¸ºæ•°å€¼ï¼Œç„¶åå†è®¡ç®—ã€‚
Math.clz32() // 32
Math.clz32(NaN) // 32
Math.clz32(Infinity) // 32
Math.clz32(null) // 32
Math.clz32('foo') // 32
Math.clz32([]) // 32
Math.clz32({}) // 32
Math.clz32(true) // 31
```

##### Math.imul()

##### Math.fround()

##### Math.hypot()

#### å¯¹æ•°æ–¹æ³•

##### Math.expm1()

##### Math.log1p()

##### Math.log10()

##### Math.Math.log2()

#### åŒæ›²å‡½æ•°æ–¹æ³•

##### Math.sinh(x) è¿”å›xçš„åŒæ›²æ­£å¼¦ï¼ˆhyperbolic sineï¼‰

##### Math.cosh(x) è¿”å›xçš„åŒæ›²ä½™å¼¦ï¼ˆhyperbolic cosineï¼‰

##### Math.tanh(x) è¿”å›xçš„åŒæ›²æ­£åˆ‡ï¼ˆhyperbolic tangentï¼‰

##### Math.asinh(x) è¿”å›xçš„ååŒæ›²æ­£å¼¦ï¼ˆinverse hyperbolic sineï¼‰

##### Math.acosh(x) è¿”å›xçš„ååŒæ›²ä½™å¼¦ï¼ˆinverse hyperbolic cosineï¼‰

##### Math.atanh(x) è¿”å›xçš„ååŒæ›²æ­£åˆ‡ï¼ˆinverse hyperbolic tangentï¼‰

### æŒ‡æ•°è¿ç®—ç¬¦

ES2016 æ–°å¢äº†ä¸€ä¸ªæŒ‡æ•°è¿ç®—ç¬¦ï¼ˆ**ï¼‰ã€‚

```js
2 ** 2 // 4
2 ** 3 // 8

// è¿™ä¸ªè¿ç®—ç¬¦çš„ä¸€ä¸ªç‰¹ç‚¹æ˜¯å³ç»“åˆï¼Œè€Œä¸æ˜¯å¸¸è§çš„å·¦ç»“åˆã€‚å¤šä¸ªæŒ‡æ•°è¿ç®—ç¬¦è¿ç”¨æ—¶ï¼Œæ˜¯ä»æœ€å³è¾¹å¼€å§‹è®¡ç®—çš„ã€‚
2 ** 3 ** 2  // 512, ç›¸å½“äº 2 ** (3 ** 2)

// æŒ‡æ•°è¿ç®—ç¬¦å¯ä»¥ä¸ç­‰å·ç»“åˆï¼Œå½¢æˆä¸€ä¸ªæ–°çš„èµ‹å€¼è¿ç®—ç¬¦ï¼ˆ**=ï¼‰ã€‚
let a = 1.5;
a **= 2; // ç›¸å½“äº a çš„ 2æ¬¡æ–¹ï¼Œç­‰åŒäº a = a * a;
let b = 4;
b **= 3; //ç›¸å½“äº b çš„ 3 æ¬¡æ–¹ï¼Œç­‰åŒäº b = b * b * b;

// æ³¨æ„ï¼ŒV8 å¼•æ“çš„æŒ‡æ•°è¿ç®—ç¬¦ä¸Math.powçš„å®ç°ä¸ç›¸åŒï¼Œå¯¹äºç‰¹åˆ«å¤§çš„è¿ç®—ç»“æœï¼Œä¸¤è€…ä¼šæœ‰ç»†å¾®çš„å·®å¼‚ã€‚
Math.pow(99, 99)
// 3.697296376497263e+197

99 ** 99
// 3.697296376497268e+197

// ä¸Šé¢ä»£ç ä¸­ï¼Œä¸¤ä¸ªè¿ç®—ç»“æœçš„æœ€åä¸€ä½æœ‰æ•ˆæ•°å­—æ˜¯æœ‰å·®å¼‚çš„ã€‚

```
