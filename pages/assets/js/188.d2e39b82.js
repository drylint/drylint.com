(window.webpackJsonp=window.webpackJsonp||[]).push([[188],{391:function(v,_,t){"use strict";t.r(_);var a=t(6),s=Object(a.a)({},(function(){var v=this,_=v.$createElement,t=v._self._c||_;return t("ContentSlotsDistributor",{attrs:{"slot-key":v.$parent.slotKey}},[t("h1",{attrs:{id:"数据库维护"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#数据库维护"}},[v._v("#")]),v._v(" 数据库维护")]),v._v(" "),t("h2",{attrs:{id:"备份数据"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#备份数据"}},[v._v("#")]),v._v(" 备份数据")]),v._v(" "),t("p",[v._v("像所有数据一样，MySQL的数据也必须经常备份。由于MySQL数据库是基于磁盘的文件，普通的备份系统和例程就能备份MySQL的数据。但是，由于这些文件总是处于打开和使用状态，普通的文件副本备份不一定总是有效。")]),v._v(" "),t("p",[v._v("下面列出这个问题的可能解决方案：")]),v._v(" "),t("ul",[t("li",[v._v("使用命令行实用程序 mysqldump 转储所有数据库内容到某个外部文件。在进行常规备份前这个实用程序应该正常运行，以便能正确地备份转储文件。")]),v._v(" "),t("li",[v._v("可用命令行实用程序 mysqlhotcopy 从一个数据库复制所有数据（并非所有数据库引擎都支持这个实用程序）。")]),v._v(" "),t("li",[v._v("可以使用MySQL的 BACKUP TABLE 或 SELECT INTO OUTFILE 转储所有数据到某个外部文件。这两条语句都接受将要创建的系统文件名，此系统文件必须不存在，否则会出错。数据可以用 RESTORETABLE 来复原。")])]),v._v(" "),t("p",[v._v("为了保证所有数据被写到磁盘（包括索引数据），可能需要在进行备份前使用 FLUSH TABLES 语句刷新未写数据。")]),v._v(" "),t("h2",{attrs:{id:"维护"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#维护"}},[v._v("#")]),v._v(" 维护")]),v._v(" "),t("ul",[t("li",[v._v("ANALYZE TABLE ，用来检查表键是否正确。 ANALYZE TABLE 返回如下所示的状态信息：")]),v._v(" "),t("li",[v._v("CHECK TABLE 用来针对许多问题对表进行检查。在 MyISAM 表上还对索引进行检查。 CHECK TABLE 支持一系列的用于 MyISAM 表的方式。CHANGED 检查自最后一次检查以来改动过的表。 EXTENDED 执行最彻底的检查， FAST 只检查未正常关闭的表， MEDIUM 检查所有被删除的链接并进行键检验， QUICK 只进行快速扫描。如下所示， CHECKTABLE 发现和修复问题")]),v._v(" "),t("li",[v._v("如果 MyISAM 表访问产生不正确和不一致的结果，可能需要用REPAIR TABLE 来修复相应的表。这条语句不应该经常使用，如果需要经常使用，可能会有更大的问题要解决。")]),v._v(" "),t("li",[v._v("如果从一个表中删除大量数据，应该使用 OPTIMIZE TABLE 来收回所用的空间，从而优化表的性能。")])]),v._v(" "),t("h2",{attrs:{id:"诊断启动问题"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#诊断启动问题"}},[v._v("#")]),v._v(" 诊断启动问题")]),v._v(" "),t("p",[v._v("服务器启动问题通常在对MySQL配置或服务器本身进行更改时出现。MySQL在这个问题发生时报告错误，但由于多数MySQL服务器是作为系统进程或服务自动启动的，这些消息可能看不到。在排除系统启动问题时，首先应该尽量用手动启动服务器。MySQL服务器自身通过在命令行上执行 mysqld 启动。下面是几个重要的 mysqld命令行选项：")]),v._v(" "),t("ul",[t("li",[v._v("--help 显示帮助——一个选项列表；")]),v._v(" "),t("li",[v._v("--safe-mode 装载减去某些最佳配置的服务器；")]),v._v(" "),t("li",[v._v("--verbose 显示全文本消息（为获得更详细的帮助消息与 --help 联合使用）；")]),v._v(" "),t("li",[v._v("--version 显示版本信息然后退出。")])]),v._v(" "),t("p",[v._v("几个另外的命令行选项（与日志文件的使用有关）在下一节列出。")]),v._v(" "),t("h2",{attrs:{id:"查看日志文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查看日志文件"}},[v._v("#")]),v._v(" 查看日志文件")]),v._v(" "),t("p",[v._v("MySQL维护管理员依赖的一系列日志文件。主要的日志文件有以下几种。")]),v._v(" "),t("ul",[t("li",[v._v("错误日志。它包含启动和关闭问题以及任意关键错误的细节。此日志通常名为 hostname.err ，位于 data 目录中。此日志名可用 "),t("code",[v._v("--log-error")]),v._v(" 命令行选项更改。")]),v._v(" "),t("li",[v._v("查询日志。它记录所有 MySQL 活动，在诊断问题时非常有用。此日志文件可能会很快地变得非常大，因此不应该长期使用它。此日志通常名为 hostname.log ，位于 data 目录中。此名字可以用 "),t("code",[v._v("--log")]),v._v(" 命令行选项更改。")]),v._v(" "),t("li",[v._v("二进制日志。它记录更新过数据（或者可能更新过数据）的所有语句。此日志通常名为 hostname-bin ，位于 data 目录内。此名字可以用 "),t("code",[v._v("--log-bin")]),v._v(" 命令行选项更改。注意，这个日志文件是 MySQL5 中添加的，以前的MySQL版本中使用的是更新日志。")]),v._v(" "),t("li",[v._v("缓慢查询日志。顾名思义，此日志记录执行缓慢的任何查询。这个日志在确定数据库何处需要优化很有用。此日志通常名为 hostname-slow.log ， 位于 data 目录中 。 此名字可以用 "),t("code",[v._v("--log-slow-queries")]),v._v(" 命令行选项更改。在使用日志时，可用 "),t("code",[v._v("FLUSH LOGS")]),v._v(" 语句来刷新和重新开始所有日志文件。")])])])}),[],!1,null,null,null);_.default=s.exports}}]);